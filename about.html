<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Video Cursor Trail</title>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/p5.min.js"></script>

  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      background: #000;
      overflow: hidden;
    }

    #p5-holder {
      width: 100%;
      height: 100%;
    }
  </style>
</head>

<body>
  <div id="p5-holder"></div>

  <script>
    new p5((p) => {

      /* ========= CONFIG ========= */

      const STREAM_DOMAIN =
        "https://customer-pz1quf3nakoocijj.cloudflarestream.com";

      const videoIDs = [
        "60c1d098633c336b9aa1bf156cffaff6",
        "b9cffa15ac0fe9a76e2105844206ae9e",
        "2dbd7a467c28852c4b0bda6f5548b338",
        "444dfeadade4cc92bd67b33079ad20b1",
        "6c933fc0db225e0aae9537c58c917025",
        "7ba8c716b6997540ca3a1b045119d62a",
        "e977b3c01aae4b32fa1f79b684f94f59",
        "0d839285f84ca2735622faa2de9c8802"
      ];

      const TILE_SIZE = 140;
      const TRAIL_COUNT = videoIDs.length;

      /* ========= STATE ========= */

      let videos = [];
      let trail = [];

      /* ========= SETUP ========= */

      p.setup = () => {
        p.createCanvas(p.windowWidth, p.windowHeight).parent("p5-holder");

        // cria os vídeos
        videoIDs.forEach((id, i) => {
          const url = `${STREAM_DOMAIN}/downloads/${id}.mp4`;
          const v = p.createVideo(url);

          v.volume(0);
          v.loop();
          v.hide();
          v.elt.muted = true;
          v.elt.setAttribute("playsinline", "");

          videos.push(v);

          trail.push({
            x: p.mouseX,
            y: p.mouseY
          });
        });
      };

      p.windowResized = () => {
        p.resizeCanvas(p.windowWidth, p.windowHeight);
      };

      /* ========= DRAW ========= */

      p.draw = () => {
        p.background(0);

        // suaviza o trail
        trail[0].x = p.lerp(trail[0].x, p.mouseX, 0.25);
        trail[0].y = p.lerp(trail[0].y, p.mouseY, 0.25);

        for (let i = 1; i < trail.length; i++) {
          trail[i].x = p.lerp(trail[i].x, trail[i - 1].x, 0.25);
          trail[i].y = p.lerp(trail[i].y, trail[i - 1].y, 0.25);
        }

        // desenha os vídeos
        for (let i = 0; i < videos.length; i++) {
          const v = videos[i];
          const t = trail[i];

          p.push();
          p.translate(t.x, t.y);
          p.imageMode(p.CENTER);
          p.image(v, 0, 0, TILE_SIZE, TILE_SIZE);
          p.pop();
        }
      };
    });
  </script>
</body>
</html>
